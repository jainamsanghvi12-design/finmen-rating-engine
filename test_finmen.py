test_finmen.py"""\nFINMEN Testing Suite - Validate all components before deployment\nRun this script: python test_finmen.py\n"""\n\nimport sys\nimport os\nfrom datetime import datetime\n\n# Color codes for terminal output\nGREEN = '\\033[92m'\nRED = '\\033[91m'\nYELLOW = '\\033[93m'\nBLUE = '\\033[94m'\nRESET = '\\033[0m'\nBOLD = '\\033[1m'\n\ntest_results = {\n    'passed': 0,\n    'failed': 0,\n    'warnings': 0\n}\n\ndef print_header(text):\n    print(f"\\n{BOLD}{BLUE}{'='*60}{RESET}")\n    print(f"{BOLD}{BLUE}{text.center(60)}{RESET}")\n    print(f"{BOLD}{BLUE}{'='*60}{RESET}\\n")\n\ndef print_test(test_name, status, message=""):\n    if status == "PASS":\n        print(f"{GREEN}âœ“ PASS{RESET}: {test_name}")\n        test_results['passed'] += 1\n    elif status == "FAIL":\n        print(f"{RED}âœ— FAIL{RESET}: {test_name}")\n        if message:\n            print(f"  {RED}â†’ {message}{RESET}")\n        test_results['failed'] += 1\n    elif status == "WARN":\n        print(f"{YELLOW}âš  WARN{RESET}: {test_name}")\n        if message:\n            print(f"  {YELLOW}â†’ {message}{RESET}")\n        test_results['warnings'] += 1\n\ndef test_imports():\n    """Test if all required modules can be imported"""\n    print_header("Testing Module Imports")\n    \n    modules_to_test = [\n        ('streamlit', 'Streamlit'),\n        ('pandas', 'Pandas'),\n        ('google.auth', 'Google Auth'),\n        ('gspread', 'Gspread'),\n    ]\n    \n    for module_name, display_name in modules_to_test:\n        try:\n            __import__(module_name)\n            print_test(f"Import {display_name}", "PASS")\n        except ImportError as e:\n            print_test(f"Import {display_name}", "FAIL", str(e))\n\ndef test_files_exist():\n    """Test if all required files exist"""\n    print_header("Testing Required Files")\n    \n    required_files = [\n        'app.py',\n        'peer_matcher.py',\n        'search_engine.py',\n        'ai_analyzer.py',\n        'requirements.txt',\n        'README.md',\n        '.env.example',\n    ]\n    \n    for file_name in required_files:\n        if os.path.exists(file_name):\n            print_test(f"File exists: {file_name}", "PASS")\n        else:\n            print_test(f"File exists: {file_name}", "FAIL", "File not found")\n\ndef test_peer_matcher():\n    """Test peer matcher module"""\n    print_header("Testing Peer Matcher Engine")\n    \n    try:\n        from peer_matcher import PeerMatcher\n        pm = PeerMatcher()\n        print_test("Peer Matcher initialization", "PASS")\n        \n        # Test peer matching\n        peers = pm.find_peers(\n            company_name='Ashiana Housing',\n            industry='Real Estate',\n            rating='A+',\n            top_n=3\n        )\n        \n        if peers and len(peers) > 0:\n            print_test("Peer matching", "PASS", f"Found {len(peers)} peers")\n        else:\n            print_test("Peer matching", "FAIL", "No peers found")\n            \n    except Exception as e:\n        print_test("Peer Matcher", "FAIL", str(e))\n\ndef test_search_engine():\n    """Test search engine module"""\n    print_header("Testing Search Engine")\n    \n    try:\n        from search_engine import FullTextSearchEngine\n        se = FullTextSearchEngine()\n        print_test("Search Engine initialization", "PASS")\n        \n        # Test document indexing\n        se.index_document(\n            doc_id='test_1',\n            company='Test Company',\n            agency='CRISIL',\n            rating='AA',\n            content='This is a test rationale for testing purposes'\n        )\n        print_test("Document indexing", "PASS")\n        \n        # Test search\n        results = se.search('test', limit=10)\n        if results:\n            print_test("Search functionality", "PASS", f"Found {len(results)} results")\n        else:\n            print_test("Search functionality", "WARN", "No results found for test query")\n            \n    except Exception as e:\n        print_test("Search Engine", "FAIL", str(e))\n\ndef test_ai_analyzer():\n    """Test AI analyzer module"""\n    print_header("Testing AI Analyzer")\n    \n    try:\n        from ai_analyzer import AIRatingAnalyzer\n        analyzer = AIRatingAnalyzer()\n        print_test("AI Analyzer initialization", "PASS")\n        \n        # Test analysis\n        result = analyzer.analyze_rationale(\n            company='Test Corp',\n            rating='A+',\n            rationale='Strong financial position with stable growth trajectory'\n        )\n        \n        if result:\n            print_test("Rationale analysis", "PASS", "Analysis completed")\n        else:\n            print_test("Rationale analysis", "WARN", "Analysis returned empty")\n            \n    except ImportError:\n        print_test("AI Analyzer", "WARN", "Module not imported (optional)")\n    except Exception as e:\n        print_test("AI Analyzer", "FAIL", str(e))\n\ndef test_dependencies():\n    """Test if requirements.txt is valid"""\n    print_header("Testing Dependencies")\n    \n    try:\n        with open('requirements.txt', 'r') as f:\n            lines = f.readlines()\n        dependencies = [line.strip() for line in lines if line.strip() and not line.startswith('#')]\n        print_test(f"Requirements.txt found", "PASS", f"Contains {len(dependencies)} dependencies")\n    except FileNotFoundError:\n        print_test("Requirements.txt", "FAIL", "File not found")\n    except Exception as e:\n        print_test("Requirements.txt", "FAIL", str(e))\n\ndef print_summary():\n    """Print test summary"""\n    print_header("Test Summary")\n    \n    total = test_results['passed'] + test_results['failed'] + test_results['warnings']\n    pass_rate = (test_results['passed'] / total * 100) if total > 0 else 0\n    \n    print(f"{BOLD}Results:{RESET}")\n    print(f"  {GREEN}Passed: {test_results['passed']}{RESET}")\n    print(f"  {YELLOW}Warnings: {test_results['warnings']}{RESET}")\n    print(f"  {RED}Failed: {test_results['failed']}{RESET}")\n    print(f"  {BOLD}Pass Rate: {pass_rate:.1f}%{RESET}")\n    \n    if test_results['failed'] == 0:\n        print(f"\\n{GREEN}{BOLD}âœ“ ALL TESTS PASSED! Ready for deployment.{RESET}")\n        return 0\n    else:\n        print(f"\\n{RED}{BOLD}âœ— Some tests failed. Fix issues before deployment.{RESET}")\n        return 1\n\nif __name__ == "__main__":\n    print(f"{BOLD}{BLUE}\\nðŸ§ª FINMEN Testing Suite{RESET}")\n    print(f"{BLUE}Started: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}{RESET}")\n    \n    test_imports()\n    test_files_exist()\n    test_peer_matcher()\n    test_search_engine()\n    test_ai_analyzer()\n    test_dependencies()\n    \n    exit_code = print_summary()\n    sys.exit(exit_code)
